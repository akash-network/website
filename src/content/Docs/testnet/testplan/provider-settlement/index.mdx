---
categories: ["Testnet"]
tags: ["Testnet", "BME", "Testing", "Provider"]
title: "Provider Settlement"
linkTitle: "Provider Settlement"
description: "Test provider ACT receipt from settlement and ACT → AKT conversion via burn"
weight: 4
---

**Important Clarification on Settlement Flow:**

Provider settlement is a **two-step process**:

1. **Step 1 - Settlement:** When deployment closes or settles, provider receives **ACT** (not AKT directly)
2. **Step 2 - Provider Burn:** Provider calls `akash tx bme burn-act` to convert ACT → AKT

The burn is **provider-initiated**, not automatic at settlement time. This allows providers to:
- Accumulate ACT and burn in batches
- Time their conversions strategically
- Potentially hold ACT if desired

**Note:** Provider software will eventually automate the `burn-act` transaction, but currently it must be done manually.

**Provider Burn Command:**
```bash
akash tx bme burn-act <amount>uact --from <provider-wallet> -y
```

**After Provider Burns ACT:**
- Provider's ACT balance decreases
- Provider receives AKT (from vault's remint_credits if sufficient, or newly minted)
- `vault-state.total_burned.uact` increases
- `vault-state.remint_credits` decreases (non-inflationary) or `total_minted.uakt` increases (inflationary)

---

### Test 3.1: Provider Receives AKT from Remint Credits

**Objective:** Verify provider receives AKT through the full settlement flow (ACT → burn → AKT) using remint credits (non-inflationary)

**Preconditions:**
- Active deployment with provider
- Vault has sufficient remint_credits

**User Actions:**
1. Record provider's initial balances:
   ```bash
   akash query bank balances <provider-address>
   ```

2. Record vault state:
   ```bash
   akash query bme vault-state
   ```
   Note: remint_credits and total_minted.uakt

3. Close deployment (or wait for settlement):
   ```bash
   akash tx deployment close --dseq <seq> --from <wallet> -y
   ```

4. Check provider received ACT:
   ```bash
   akash query bank balances <provider-address>
   ```

5. Provider burns ACT to receive AKT:
   ```bash
   akash tx bme burn-act <amount>uact --from <provider-wallet> -y
   ```

6. Wait for epoch (~1 minute):
   ```bash
   sleep 60
   ```

7. Record final state:
   ```bash
   akash query bank balances <provider-address>
   akash query bme vault-state
   ```

**Expected Results:**
- Provider ACT balance increased after settlement, then decreased after burn
- Provider AKT balance increased (from burn)
- `vault-state.total_burned.uact` increased
- `vault-state.remint_credits` decreased
- `vault-state.total_minted.uakt` **unchanged** (non-inflationary — AKT came from remint credits)

**Proof to Submit:**
- Provider ACT balance before and after settlement (showing ACT received)
- Deployment close tx hash

---

### Test 3.2: Provider Payment When AKT Price Rose

**Objective:** Verify provider receives fewer AKT when price increased (same USD value)

**How to Encounter This Scenario:**
The oracle uses real Pyth price feeds. To test this:
1. Create a deployment and note the oracle price
2. Let deployment run and accrue provider earnings
3. Monitor price — when it has **increased**, close the deployment
4. Provider burns received ACT and receives fewer AKT (same USD value)

**User Actions:**
1. Record provider's initial AKT balance:
   ```bash
   akash query bank balances <provider-address>
   ```

2. Record oracle price at deployment creation (P_start):
   ```bash
   akash query oracle prices | head -n 15
   date -u +"%Y-%m-%dT%H:%M:%S"
   ```
   **Write down the price.**

3. Create deployment and let it run (see Category 1 for full workflow):
   ```bash
   akash tx bme mint-act 100000000uakt --from <wallet> -y
   sleep 60
   akash tx deployment create deploy.yml --deposit 50000000uact --from <wallet> -y
   # Complete lease creation and send manifest...
   ```

4. Let deployment run for compute cost to accrue

5. **Wait for price to increase** — check periodically:
   ```bash
   akash query oracle prices | head -n 15
   ```
   Continue when current price > P_start
   Example: P_final = $0.50 (price increased)

6. Close deployment:
   ```bash
   akash tx deployment close --dseq <seq> --from <wallet> -y
   ```

7. Provider burns received ACT:
   ```bash
   akash tx bme burn-act <amount>uact --from <provider-wallet> -y
   sleep 60
   ```

8. Record final provider balance:
   ```bash
   akash query bank balances <provider-address>
   ```

**Expected Results:**
- Provider receives **fewer AKT** for same USD value (price increased)
- Example: $10 compute at $0.50 = 20 AKT (vs 33 AKT at $0.30)
- Provider received correct USD value in AKT terms
- `remint_credits` decreased
- `total_minted.uakt` unchanged (non-inflationary)

**Proof to Submit:**
- P_start and P_final oracle prices (showing increase)
- Provider ACT balance after settlement
- Provider AKT balance before and after burn (showing fewer AKT received)

---

### Test 3.3: Provider Payment When AKT Price Dropped (Inflationary)

**Objective:** Verify settlement mints new AKT when remint credits insufficient due to price drop

**How to Encounter This Scenario:**
The oracle uses real Pyth price feeds. To test this:
1. Create a deployment and note the oracle price
2. Let deployment run and accrue provider earnings
3. Monitor price — when it has **decreased significantly**, close the deployment
4. Provider burns received ACT and receives more AKT (same USD value, but may trigger inflation)

**User Actions:**
1. Record baseline state:
   ```bash
   akash query bank balances <provider-address>
   akash query bme vault-state
   akash query bank total --denom uakt
   ```
   Note: remint_credits, total_minted.uakt, and Total AKT supply

2. Record oracle price at deployment creation (P_start):
   ```bash
   akash query oracle prices | head -n 15
   date -u +"%Y-%m-%dT%H:%M:%S"
   ```
   **Write down the price.**

3. Create deployment:
   ```bash
   akash tx bme mint-act 100000000uakt --from <wallet> -y
   sleep 60
   akash tx deployment create deploy.yml --deposit 50000000uact --from <wallet> -y
   # Complete lease creation and send manifest...
   ```

4. Let deployment run for compute cost to accrue

5. **Wait for price to decrease** — check periodically:
   ```bash
   akash query oracle prices | head -n 15
   ```
   Continue when current price < P_start (ideally significant drop)

6. Close deployment:
   ```bash
   akash tx deployment close --dseq <seq> --from <wallet> -y
   ```

7. Provider burns received ACT:
   ```bash
   akash tx bme burn-act <amount>uact --from <provider-wallet> -y
   sleep 60
   ```

8. Record final state:
   ```bash
   akash query bank balances <provider-address>
   akash query bme vault-state
   akash query bank total --denom uakt
   ```

**Expected Results:**
- Provider receives **more AKT** for same USD value (price decreased)
- Provider receives full AKT amount owed
- `remint_credits` depleted (reduced to 0 or near 0)
- **`total_minted.uakt` increased** (inflationary — new AKT was minted)
- **Total AKT supply increased**

**Critical Verification:**
- Compare total AKT supply before/after using `akash query bank total --denom uakt`
- This confirms the inflationary path works correctly

**Proof to Submit:**
- P_start and P_final oracle prices (showing decrease)
- Pre/post vault state showing total_minted.uakt increase
- Pre/post total AKT supply (showing increase)

---

### Test 3.4: Multiple Settlements - Remint Credit Depletion

**Objective:** Verify system behavior as remint credits deplete across multiple settlements

**How to Encounter This Scenario:**
This test observes remint credit depletion over time. It works best when:
1. You have a long-running deployment accruing significant provider earnings
2. The price drops during the deployment lifetime
3. Multiple settlement epochs occur at the lower price

You can let this happen naturally over hours/days as price fluctuates.

**User Actions:**
1. Create deployment with significant AKT deposit:
   ```bash
   akash tx bme mint-act 300000000uakt --from <wallet> -y
   sleep 60
   akash tx deployment create deploy.yml --deposit 150000000uact --from <wallet> -y
   # Complete lease creation and send manifest...
   ```

2. Record initial vault state and oracle price:
   ```bash
   akash query bme vault-state
   akash query oracle prices | head -n 15
   ```
   Note: remint_credits, total_minted.uakt, and starting price

3. Let deployment run for extended period (hours or longer)
   - Monitor price periodically
   - Price drops will cause provider burn to require more AKT per ACT

4. Track remint_credits and total_minted.uakt periodically:
   ```bash
   # Run periodically
   akash query bme vault-state
   ```

5. After settlements occur, have provider burn accumulated ACT:
   ```bash
   akash tx bme burn-act <amount>uact --from <provider-wallet> -y
   sleep 60
   akash query bme vault-state
   ```

**Expected Results:**

| Phase | remint_credits | total_minted.uakt | Notes |
|-------|----------------|-------------------|-------|
| Initial | ~300 AKT | X | Baseline |
| Settlement 1 | ↓ | X (unchanged) | Using remint credits |
| Settlement 2 | ↓ | X (unchanged) | Using remint credits |
| ... | ↓ | X (unchanged) | Using remint credits |
| Credits depleted | 0 | X (unchanged) | Credits exhausted |
| Next settlement | 0 | ↑ | **Inflationary minting begins** |

**Key Observations:**
- First settlements use remint credits only (non-inflationary)
- Eventually remint credits deplete to 0
- Later settlements require new AKT minting (inflationary)
- Clear transition visible when total_minted.uakt starts increasing

**⚠️ Important:** Close deployment when testing is complete:
```bash
akash tx deployment close --dseq <dseq> --from <wallet> -y
```

**Proof to Submit:**
- Initial vault state (remint_credits, total_minted.uakt)
- Periodic vault state snapshots showing remint_credits decreasing
- Evidence of transition to inflationary minting (total_minted.uakt increase)
---
categories: ["Testnet"]
tags: ["Testnet", "BME", "Testing", "Provider"]
title: "Provider Settlement"
linkTitle: "Provider Settlement"
description: "Verify providers receive AKT through BME settlement process"
weight: 4
---

**Important Clarification on Settlement Flow:**

Provider settlement is a **two-step process**:

1. **Step 1 - Settlement:** When deployment closes or settles, provider receives **ACT** (not AKT directly)
2. **Step 2 - Provider Burn:** Provider calls `akash tx bme burn-act` to convert ACT → AKT

The burn is **provider-initiated**, not automatic at settlement time. This allows providers to:
- Accumulate ACT and burn in batches
- Time their conversions strategically
- Potentially hold ACT if desired

**Note:** Provider software will eventually automate the `burn-act` transaction, but currently it must be done manually.

**Provider Burn Command:**
```bash
akash tx bme burn-act <amount>uact --from <provider-wallet> -y
```

**After Provider Burns ACT:**
- Provider's ACT balance decreases
- Provider receives AKT (from vault's remint_credits if sufficient, or newly minted)
- `vault-state.total_burned.uact` increases
- `vault-state.remint_credits` decreases (non-inflationary) or `total_minted.uakt` increases (inflationary)

---

### Test 3.1: Provider Receives AKT from Remint Credits

**Objective:** Verify provider receives AKT through the full settlement flow (ACT → burn → AKT) using remint credits (non-inflationary)

**Preconditions:**
- Active deployment with provider
- Vault has sufficient remint_credits

**User Actions:**
1. Record provider's initial balances:
   ```bash
   akash query bank balances <provider-address>
   ```

2. Record vault state:
   ```bash
   akash query bme vault-state
   ```
   Note: remint_credits and total_minted.uakt

3. Close deployment (or wait for settlement):
   ```bash
   akash tx deployment close --dseq <seq> --from <wallet> -y
   ```

4. Check provider received ACT:
   ```bash
   akash query bank balances <provider-address>
   ```

5. Provider burns ACT to receive AKT:
   ```bash
   akash tx bme burn-act <amount>uact --from <provider-wallet> -y
   ```

6. Wait for epoch (~1 minute):
   ```bash
   sleep 60
   ```

7. Record final state:
   ```bash
   akash query bank balances <provider-address>
   akash query bme vault-state
   ```

**Expected Results:**
- Provider ACT balance increased after settlement, then decreased after burn
- Provider AKT balance increased (from burn)
- `vault-state.total_burned.uact` increased
- `vault-state.remint_credits` decreased
- `vault-state.total_minted.uakt` **unchanged** (non-inflationary — AKT came from remint credits)

---

### Test 3.2: Provider Payment When AKT Price Rose

**Objective:** Verify provider receives fewer AKT when price increased (same USD value)

**Precondition:** This test requires oracle price manipulation. Coordinate with Akash Core team to adjust the oracle price, or wait for natural market price movement.

**User Actions:**
1. Record provider's initial AKT balance:
   ```bash
   akash query bank balances <provider-address>
   ```

2. Record oracle price (P_start):
   ```bash
   akash query oracle prices | head -n 15
   ```
   Example: P_start = $0.30

3. Create deployment and let it run (see Category 1 for full workflow):
   ```bash
   akash tx bme mint-act 100000000uakt --from <wallet> -y
   sleep 60
   akash tx deployment create deploy.yml --deposit 50000000uact --from <wallet> -y
   # Complete lease creation and send manifest...
   ```

4. Let deployment run for known compute cost

5. **[Coordinate with Akash Core team]** Wait for or trigger oracle price increase
   Example: P_final = $0.50 (price increased)

6. Verify price increased:
   ```bash
   akash query oracle prices | head -n 15
   ```

7. Close deployment:
   ```bash
   akash tx deployment close --dseq <seq> --from <wallet> -y
   ```

8. Provider burns received ACT:
   ```bash
   akash tx bme burn-act <amount>uact --from <provider-wallet> -y
   sleep 60
   ```

9. Record final provider balance:
   ```bash
   akash query bank balances <provider-address>
   ```

**Expected Results:**
- Provider receives **fewer AKT** for same USD value (price increased)
- Example: $10 compute at $0.50 = 20 AKT (vs 33 AKT at $0.30)
- Provider received correct USD value in AKT terms
- `remint_credits` decreased
- `total_minted.uakt` unchanged (non-inflationary)

---

### Test 3.3: Provider Payment When AKT Price Dropped (Inflationary)

**Objective:** Verify settlement mints new AKT when remint credits insufficient due to price drop

**Precondition:** This test requires oracle price manipulation. Coordinate with Akash Core team to adjust the oracle price.

**User Actions:**
1. Record baseline state:
   ```bash
   akash query bank balances <provider-address>
   akash query bme vault-state
   akash query bank total --denom uakt
   ```
   Note: remint_credits, total_minted.uakt, and Total AKT supply

2. Record oracle price (P_start):
   ```bash
   akash query oracle prices | head -n 15
   ```
   Example: P_start = $0.50

3. Create deployment:
   ```bash
   akash tx bme mint-act 100000000uakt --from <wallet> -y
   sleep 60
   akash tx deployment create deploy.yml --deposit 50000000uact --from <wallet> -y
   # Complete lease creation and send manifest...
   ```

4. Let deployment run for compute cost

5. **[Coordinate with Akash Core team]** Trigger oracle price decrease
   Example: P_final = $0.25 (price halved)

6. Verify price decreased:
   ```bash
   akash query oracle prices | head -n 15
   ```

7. Close deployment:
   ```bash
   akash tx deployment close --dseq <seq> --from <wallet> -y
   ```

8. Provider burns received ACT:
   ```bash
   akash tx bme burn-act <amount>uact --from <provider-wallet> -y
   sleep 60
   ```

9. Record final state:
   ```bash
   akash query bank balances <provider-address>
   akash query bme vault-state
   akash query bank total --denom uakt
   ```

**Expected Results:**
- Provider receives **more AKT** for same USD value (price decreased)
- Provider receives full AKT amount owed
- `remint_credits` depleted (reduced to 0 or near 0)
- **`total_minted.uakt` increased** (inflationary — new AKT was minted)
- **Total AKT supply increased**

**Critical Verification:**
- Compare total AKT supply before/after using `akash query bank total --denom uakt`
- This confirms the inflationary path works correctly

---

### Test 3.4: Multiple Settlements - Remint Credit Depletion

**Objective:** Verify system behavior as remint credits deplete across multiple settlements

**Precondition:** This test requires oracle price manipulation and multiple settlement cycles. Coordinate with Akash Core team.

**User Actions:**
1. Create deployment with significant AKT deposit:
   ```bash
   akash tx bme mint-act 300000000uakt --from <wallet> -y
   sleep 60
   akash tx deployment create deploy.yml --deposit 150000000uact --from <wallet> -y
   # Complete lease creation and send manifest...
   ```

2. Record initial vault state:
   ```bash
   akash query bme vault-state
   ```
   Note: remint_credits and total_minted.uakt

3. **[Coordinate with Akash Core team]** Drop price so settlements require more AKT than accrued
   Example: Drop from $0.50 to $0.25

4. Let multiple settlement epochs occur (several minutes)

5. Track remint_credits and total_minted.uakt after each epoch:
   ```bash
   # Run periodically
   akash query bme vault-state
   ```

6. After each settlement, have provider burn ACT:
   ```bash
   akash tx bme burn-act <amount>uact --from <provider-wallet> -y
   sleep 60
   akash query bme vault-state
   ```

**Expected Results:**

| Phase | remint_credits | total_minted.uakt | Notes |
|-------|----------------|-------------------|-------|
| Initial | ~300 AKT | X | Baseline |
| Settlement 1 | ↓ | X (unchanged) | Using remint credits |
| Settlement 2 | ↓ | X (unchanged) | Using remint credits |
| ... | ↓ | X (unchanged) | Using remint credits |
| Credits depleted | 0 | X (unchanged) | Credits exhausted |
| Next settlement | 0 | ↑ | **Inflationary minting begins** |

**Key Observations:**
- First settlements use remint credits only (non-inflationary)
- Eventually remint credits deplete to 0
- Later settlements require new AKT minting (inflationary)
- Clear transition visible when total_minted.uakt starts increasing

**⚠️ Important:** Close deployment when testing is complete:
```bash
akash tx deployment close --dseq <dseq> --from <wallet> -y
```